#!/usr/bin/env python3

import json
import os
import sys
from spival import write_BepiColombo


#
# We search for the configuration file we try the following directories in
# the following order:
#
#    1- Current Directory
#    2- /home/user/.config/spival
#    3- /etc/spival
#
# If the configuration file is found it is loaded.
#

error_message = []
try:
    path = os.getcwd()

    with open(os.path.join('spival.json')) as f:
        config = json.load(f)

except Exception as msg:
    try:
        path = os.path.expanduser("~")

        with open(os.path.join('/spival/spival.json')) as f:
            config = json.load(f)
        error_message.append(msg)

    except Exception as msg:
        try:
            with open('/etc/spival/spival.json') as f:
                config = json.load(f)
            error_message.append(msg)

        except Exception as msg:

            error_message.append(msg)
            print('Error: The spival configuration file is not available')
            print('       Please make sure that spival.json is located either:')
            print('          1- Current Directory')
            print('          2- /home/user/.config/spival')
            print('          3- /etc/spival')
            sys.exit(1)

#
# spival is executed with the loaded configuration file
#
write_BepiColombo(config)